// Generated by CoffeeScript 1.6.1

/*!
  # Responsive Celendar widget script
  # by w3widgets
  #
  # Author: Lukasz Kokoszkiewicz
  #
  # Copyright Â© w3widgets 2013 All Rights Reserved
*/


(function(){!function(t){"use strict";var n,e,a;return n=function(t,n){var e;return this.$element=t,this.options=n,this.weekDays=["sun","mon","tue","wed","thu","fri","sat","sun"],this.time=new Date,this.currentYear=this.time.getFullYear(),this.currentMonth=this.time.getMonth(),this.options.time&&(e=this.splitDateString(this.options.time),this.currentYear=e.year,this.currentMonth=e.month),this.initialDraw(),null},n.prototype={addLeadingZero:function(t){return 10>t?"0"+t:""+t},applyTransition:function(t,n){return t.css("transition",n),t.css("-ms-transition","-ms-"+n),t.css("-moz-transition","-moz-"+n),t.css("-webkit-transition","-webkit-"+n)},applyBackfaceVisibility:function(t){return t.css("backface-visibility","hidden"),t.css("-ms-backface-visibility","hidden"),t.css("-moz-backface-visibility","hidden"),t.css("-webkit-backface-visibility","hidden")},applyTransform:function(t,n){return t.css("transform",n),t.css("-ms-transform",n),t.css("-moz-transform",n),t.css("-webkit-transform",n)},splitDateString:function(t){var n,e,a,i;return a=t.split("-"),i=parseInt(a[0]),e=parseInt(a[1]-1),n=parseInt(a[2]),a={year:i,month:e,day:n}},initialDraw:function(){return this.drawDays(this.currentYear,this.currentMonth)},editDays:function(t){var n,e,a,i,r;r=[];for(n in t)a=t[n],this.options.events[n]=t[n],i=this.splitDateString(n),e=this.$element.find('[data-year="'+i.year+'"][data-month="'+(i.month+1)+'"][data-day="'+i.day+'"]').parent(".day"),e.removeClass("active"),e.find(".badge").remove(),e.find("a").removeAttr("href"),this.currentMonth===i.month||this.options.activateNonCurrentMonths?r.push(this.makeActive(e,a)):r.push(void 0);return r},clearDays:function(t){var n,e,a,i,r,s;for(s=[],i=0,r=t.length;r>i;i++)n=t[i],delete this.options.events[n],a=this.splitDateString(n),e=this.$element.find('[data-year="'+a.year+'"][data-month="'+(a.month+1)+'"][data-day="'+a.day+'"]').parent(".day"),e.removeClass("active"),e.find(".badge").remove(),s.push(e.find("a").removeAttr("href"));return s},clearAll:function(){var n,e,a,i,r,s;for(this.options.events={},e=this.$element.find('[data-group="days"] .day'),s=[],a=i=0,r=e.length;r>i;a=++i)n=e[a],t(n).removeClass("active"),t(n).find(".badge").remove(),s.push(t(n).find("a").removeAttr("href"));return s},setMonthYear:function(t){var n;return n=this.splitDateString(t),this.currentMonth=this.drawDays(n.year,n.month),this.currentYear=n.year},prev:function(){return this.currentMonth-1<0?(this.currentYear=this.currentYear-1,this.currentMonth=11):this.currentMonth=this.currentMonth-1,this.drawDays(this.currentYear,this.currentMonth),this.options.onMonthChange&&this.options.onMonthChange.call(this),null},next:function(){return this.currentMonth+1>11?(this.currentYear=this.currentYear+1,this.currentMonth=0):this.currentMonth=this.currentMonth+1,this.drawDays(this.currentYear,this.currentMonth),this.options.onMonthChange&&this.options.onMonthChange.call(this),null},curr:function(){return this.currentYear=this.time.getFullYear(),this.currentMonth=this.time.getMonth(),this.drawDays(this.currentYear,this.currentMonth),this.options.onMonthChange&&this.options.onMonthChange.call(this),null},addOthers:function(n,e){var a;return"object"==typeof e&&(null!=e.number&&(a=t("<span></span>").html(e.number).addClass("badge"),null!=e.badgeClass&&a.addClass(e.badgeClass),n.append(a)),e.url&&n.find("a").attr("href",e.url)),n},makeActive:function(t,n){var e,a,i,r,s;if(n){if(n["class"])for(e=n["class"].split(" "),i=r=0,s=e.length;s>r;i=++r)a=e[i],t.addClass(a);else t.addClass("active");t=this.addOthers(t,n)}return t},getDaysInMonth:function(t,n){return new Date(t,n+1,0).getDate()},drawDay:function(n,e,a,i,r){var s,o,h,d,l,u;return d=t("<div></div>").addClass("day"),o=new Date,o.setHours(0,0,0,0),l=new Date(e,a-1,i),u=l.getTime()<o.getTime()?"past":l.getTime()===o.getTime()?"today active":"future",d.addClass(this.weekDays[r%7]),d.addClass(u),h=e+"-"+this.addLeadingZero(a)+"-"+this.addLeadingZero(i),(0>=i||i>n)&&(s=new Date(e,a-1,i),i=s.getDate(),a=s.getMonth()+1,e=s.getFullYear(),d.addClass("not-current").addClass(u),this.options.activateNonCurrentMonths&&(h=e+"-"+this.addLeadingZero(a)+"-"+this.addLeadingZero(i))),d.append(t("<a>"+i+"</a>").attr("data-day",i).attr("data-month",a).attr("data-year",e)),this.options.monthChangeAnimation&&(this.applyTransform(d,"rotateY(180deg)"),this.applyBackfaceVisibility(d)),d=this.makeActive(d,this.options.events[h]),this.$element.find('[data-group="days"]').append(d)},drawDays:function(n,e){var a,i,r,s,o,h,d,l,u,c,p,m,y,f,v,g,D,M;if(y=this,f=new Date(n,e),a=f.getMonth(),p=f.getMonth()+1,g=f.getFullYear(),f.setDate(1),d=this.options.startFromSunday?f.getDay()+1:f.getDay()||7,u=this.getDaysInMonth(n,e),v=0,this.options.monthChangeAnimation)for(s=this.$element.find('[data-group="days"] .day'),l=D=0,M=s.length;M>D;l=++D)i=s[l],o=.01*l,this.applyTransition(t(i),"transform .5s ease "+o+"s"),this.applyTransform(t(i),"rotateY(180deg)"),this.applyBackfaceVisibility(t(i)),v=1e3*(o+.1);return r=2,this.options.allRows?c=42:(m=Math.ceil((d-(r-1)+u)/7),c=7*m),this.$element.find("[data-head-year]").html(f.getFullYear()),this.$element.find("[data-head-month]").html(this.options.translateMonths[f.getMonth()]),h=function(){var n,e;for(y.$element.find('[data-group="days"]').empty(),n=r-d,l=y.options.startFromSunday?0:1;c-d+r>n;)y.drawDay(u,g,p,n,l),n+=1,l+=1;return e=function(){var n,e;for(s=y.$element.find('[data-group="days"] .day'),l=n=0,e=s.length;e>n;l=++n)i=s[l],y.applyTransition(t(i),"transform .5s ease "+.01*l+"s"),y.applyTransform(t(i),"rotateY(0deg)");return y.options.onDayClick&&y.$element.find('[data-group="days"] .day a').click(function(){return y.options.onDayClick.call(this,y.options.events)}),y.options.onDayHover&&y.$element.find('[data-group="days"] .day a').hover(function(){return y.options.onDayHover.call(this,y.options.events)}),y.options.onActiveDayClick&&y.$element.find('[data-group="days"] .day.active a').click(function(){return y.options.onActiveDayClick.call(this,y.options.events)}),y.options.onActiveDayHover?y.$element.find('[data-group="days"] .day.active a').hover(function(){return y.options.onActiveDayHover.call(this,y.options.events)}):void 0},setTimeout(e,0)},setTimeout(h,v),a}},t.fn.responsiveCalendar=function(e,a){var i,r,s;return r=t.extend({},t.fn.responsiveCalendar.defaults,"object"==typeof e&&e),s={next:"next",prev:"prev",edit:"editDays",clear:"clearDays",clearAll:"clearAll",getYearMonth:"getYearMonth",jump:"jump",curr:"curr"},i=function(e){var a;return r=t.metadata?t.extend({},r,e.metadata()):r,e.data("calendar",a=new n(e,r)),r.onInit&&r.onInit.call(a),e.find("[data-go]").click(function(){return"prev"===t(this).data("go")&&a.prev(),"next"===t(this).data("go")?a.next():void 0})},this.each(function(){var n,r;return n=t(this),r=n.data("calendar"),r?"string"==typeof e?null!=s[e]?r[s[e]](a):r.setMonthYear(e):"number"==typeof e&&r.jump(Math.abs(e)+1):i(n),null})},t.fn.responsiveCalendar.defaults={translateMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],events:{},time:void 0,allRows:!0,startFromSunday:!1,activateNonCurrentMonths:!1,monthChangeAnimation:!0,onInit:void 0,onDayClick:void 0,onDayHover:void 0,onActiveDayClick:void 0,onActiveDayHover:void 0,onMonthChange:void 0},a=t('[data-spy="responsive-calendar"]'),a.length?(e={},null!=a.data("translate-months")&&(e.translateMonths=a.data("translate-months").split(",")),null!=a.data("time")&&(e.time=a.data("time")),null!=a.data("all-rows")&&(e.allRows=a.data("all-rows")),null!=a.data("start-from-sunday")&&(e.startFromSunday=a.data("start-from-sunday")),null!=a.data("activate-non-current-months")&&(e.activateNonCurrentMonths=a.data("activate-non-current-months")),null!=a.data("month-change-animation")&&(e.monthChangeAnimation=a.data("month-change-animation")),a.responsiveCalendar(e)):void 0}(jQuery)}).call(this);